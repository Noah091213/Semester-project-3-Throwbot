\chapter{Discussion}
\label{chap:discussion}

\section{Trajectory Planning}
Generating a trajectory for the ball and subsequently a path for the robot can be done in a multitude of ways, each with pros and cons. Therefore, one should consider what the objective is and define the problem in detail before choosing a method. The methods chosen for this project were all decided based on their expected impact on the project goal. 

As the complete trajectory planning includes a substantial amount of parameters that can be tweaked endlessly, it essentially becomes an optimization problem. Since each parameter change will affect how all other parameters act, finding the perfect solution for any throw is almost impossible. Due to this fact, the approach when choosing static variables or calculation methods, differed based on the expected impact of that variable. For some calculations rigorous testing was done to find the impact of change in those variables, while for others simple hypothesis and limited testing was applied to make the decision.

\subsection{Ball Trajectory}
The ball's trajectory can be optimized to achieve different goals. The problem definition dictated the decisions as to how these calculations were done. In the spirit of the project, \emph{throwing} an object was defined such that the object must travel some distance horizontally and must have an upwards trajectory at the release point. In order to achieve this, the ball trajectory calculation enforces a minimum pitch of 22.5 degrees ($\pi /8 \ radians$). This enforcement is important, because the secondary goal of the calculation is to find the trajectory which requires the lowest necessary velocity. A low velocity is helpful when determining the robots path, as less space is needed to accelerate, thus limiting the range of motion and increasing the chance of staying within limits. 

However, since the TCP cannot get near the table, where the target is placed, all throws will have a release point higher than the target point. The lowest velocity necessary for such a throw is likely found with a negative or near 0 pitch, which does not satisfy the project definition of a throw. And thus the arbitrary enforcement of 22.5 degrees was implemented.

\subsection{Robot Path Planning}
As the robot is limited in both Cartesian and joint space, planning the path in either space leads to an unknown degree of complications in the other. As the joint restriction are generally harsher than the Cartesian boundaries, it was natural to do the path planning in joint space. This allows for full control of the joints positions at all times, however, it also limits the ability to generate specific movements in Cartesian space. The most important task of the path planning is to ensure that the TCP hits the release point in Cartesian space while moving in the direction of the ball's calculation trajectory with the correct velocity. Splitting the path planning in two sections makes this task much easier to achieve, as it is now possible to define the release point as either a start of end position in the trajectory, rather than some point along the path. With the path split in two, each section can now aim to achieve different goals.

The lead-up trajectory's goal is to hit the release point with the correct speed, this must be done while staying within joint limits. Calculating this part in joint space means it is possible to limit the range of motion needed for each joint based on its acceleration. However, that also means the correct velocity and direction in Cartesian space can only be ensured at the exact point of release. Any point before that may have any random direction and velocity at the TCP.

Since some error margin in the release timing must be expected, i.e. it might not be possible to have the ball lose contact with the gripper in that exact moment in time, it seemed optimal to have the TCP move in the direction of the ball trajectory for some amount of time. This becomes the goal of the follow-through section of the path. Determining this sequence in Cartesian space, allows the calculations to enforce a linear Cartesian direction of the TCP. During this movement, the robot also decelerates, which achieves two things. Firstly, the robot needs to slow down before hitting its physical limits and safety restriction. Secondly, the deceleration may counter the error margin in release timing. If the ball is released slightly too late, it will still be traveling in the correct direction towards the target, and though it is released closer to the target than expected, it is also released with a lower velocity. 

